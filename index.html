import { useState } from "react";
import mtnBg from "./mtn-bg.jpg";       // <-- MTN yellow background
import telecelBg from "./telecel-bg.jpg"; // <-- Telecel red background

export default function CyrusDataHub() {
  const [showMTN, setShowMTN] = useState(false);
  const [showTelecel, setShowTelecel] = useState(false);
  const [selectedBundle, setSelectedBundle] = useState("");
  const [phone, setPhone] = useState("");
  const [screenshot, setScreenshot] = useState(null);
  const [preview, setPreview] = useState(null);
  const [activeNetwork, setActiveNetwork] = useState("MTN"); // background switch

  // ✅ Updated MTN bundles
  const mtnBundles = [
    "1GB – ₵6",
    "2GB – ₵11",
    "3GB – ₵17",
    "4GB – ₵22",
    "5GB – ₵26",
    "6GB – ₵31",
    "7GB – ₵35",
    "8GB – ₵45",
    "9GB – ₵50",
    "10GB – ₵50",
    "15GB – ₵67",
    "20GB – ₵86",
    "25GB – ₵135",
    "30GB – ₵145",
    "40GB – ₵165",
  ];

  // ✅ Telecel bundles
  const telecelBundles = [
    "5GB – ₵25",
    "10GB – ₵50",
    "15GB – ₵68",
    "20GB – ₵85",
    "30GB – ₵125",
    "40GB – ₵147",
    "50GB – ₵220",
  ];

  const handleFileUpload = (e) => {
    const file = e.target.files[0];
    if (file) {
      setScreenshot(file);
      setPreview(URL.createObjectURL(file));
    }
  };

  const handleWhatsApp = (network) => {
    const msg = `Hello, I want to buy ${network} DATA
Bundle: ${selectedBundle}
Beneficiary: ${phone}
(Note: please attach your payment screenshot)`;
    window.open(
      `https://wa.me/233502376541?text=${encodeURIComponent(msg)}`,
      "_blank"
    );
  };

  const Modal = ({ network, bundles, onClose }) => (
    <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
      <div className="bg-white rounded-2xl p-6 max-w-md w-full">
        <h2 className="text-xl font-bold mb-4">{network} DATA</h2>

        {/* Bundle selection */}
        <label className="block mb-2 font-medium">Select Bundle</label>
        <select
          onChange={(e) => setSelectedBundle(e.target.value)}
          className="w-full p-2 border rounded mb-4"
        >
          <option value="">-- Choose a bundle --</option>
          {bundles.map((b, i) => (
            <option key={i} value={b}>
              {b}
            </option>
          ))}
        </select>

        {/* Phone number input */}
        <label className="block mb-2 font-medium">Beneficiary Phone Number</label>
        <input
          type="text"
          placeholder="Enter phone number"
          value={phone}
          onChange={(e) => setPhone(e.target.value)}
          className="w-full p-2 border rounded mb-4"
        />

        {/* Screenshot upload */}
        <label className="block mb-2 font-medium">Upload Payment Screenshot</label>
        <input type="file" accept="image/*" onChange={handleFileUpload} className="mb-4" />
        {preview && <img src={preview} alt="screenshot preview" className="mb-4 rounded" />}

        {/* Buy Now button */}
        <button
          onClick={() => handleWhatsApp(network)}
          className="bg-green-600 text-white w-full py-2 rounded-lg mb-2"
        >
          Buy Now
        </button>

        {/* Close button */}
        <button onClick={onClose} className="text-gray-600 underline w-full">
          Cancel
        </button>
      </div>
    </div>
  );

  // ✅ Background logic
  const bgImage = activeNetwork === "MTN" ? mtnBg : telecelBg;

  return (
    <div
      className="min-h-screen flex flex-col items-center justify-center p-6 bg-cover bg-center"
      style={{ backgroundImage: `url(${bgImage})` }}
    >
      <div className="bg-white bg-opacity-90 p-6 rounded-2xl shadow-lg w-full max-w-lg">
        <h1 className="text-2xl font-bold mb-6 text-center">
          Cyrus Data Hub – Cheap MTN & Telecel Bundles
        </h1>

        <div className="grid grid-cols-2 gap-6">
          {/* MTN button */}
          <button
            onClick={() => {
              setShowMTN(true);
              setActiveNetwork("MTN");
            }}
            className="bg-yellow-500 text-black p-6 rounded-2xl shadow-lg font-bold"
          >
            MTN Bundles
          </button>

          {/* Telecel button */}
          <button
            onClick={() => {
              setShowTelecel(true);
              setActiveNetwork("Telecel");
            }}
            className="bg-red-600 text-white p-6 rounded-2xl shadow-lg font-bold"
          >
            Telecel Bundles
          </button>
        </div>

        {/* Business Info */}
        <div className="mt-6 text-center text-sm text-gray-800">
          <p>We work from Monday to Saturday (Closed on Sundays).</p>
          <p>Closing time: 9 PM daily.</p>
          <p className="mt-2">
            Send money to <strong>0502376541</strong> (Vodafone number).
          </p>
          <p>
            MTN users must choose “Other Networks” when sending. Vodafone users send directly.
          </p>
        </div>
      </div>

      {/* Modals */}
      {showMTN && (
        <Modal network="MTN" bundles={mtnBundles} onClose={() => setShowMTN(false)} />
      )}
      {showTelecel && (
        <Modal
          network="Telecel"
          bundles={telecelBundles}
          onClose={() => setShowTelecel(false)}
        />
      )}
    </div>
  );
}
